<!DOCTYPE html>
<html>
<head>
<title>Jsonnet Training Materials</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="md2html">
</head>
<body>
<p>[<a href="index.html">index</a>]</p>
<h1>Jsonnet Training Materials</h1>
<p>Excited as you might be after following the <a href="https://jsonnet.org/learning/tutorial.html">excellent jsonnet.org tutorial</a>,
it can still be daunting to actually use Jsonnet in the real world. Instead of working
with arbitrary examples like cocktails or your favorite pets, these training materials
contain real worlds examples (good and bad) in the hope to lower the bar of entry.</p>
<blockquote>
<p>Note: A lot of the examples will be around Kubernetes objects, but don't worry if you
don't know how Kubernetes works, this is not a requirement for understanding the Jsonnet
examples.</p>
</blockquote>
<p>TODO: Answer questions tl;dr, make reference to longer descriptions)</p>
<p>Why?</p>
<ul>
<li>Why jsonnet? What benefit do we gain from it?</li>
<li>Why is it worth the inconvenience of people having to learn a new language/paradigm?</li>
<li>Why we use jsonnet (vs other solutions/tools)?</li>
<li>TODO: Create longer retrospective design doc</li>
</ul>
<p>How?</p>
<ul>
<li>What are the lessons we’ve learned after using jsonnet for years?</li>
<li>What are some GrafanaLabs jsonnet idioms that we try to use?</li>
<li>Tools/tricks when writing/debugging jsonnet?</li>
</ul>
<p>Lessons:</p>
<ol>
<li><a href="lesson1.html">Write an extensible library</a></li>
<li><a href="lesson2.html">Package management</a></li>
<li><a href="lesson3.html">Exercise: rewrite a library with <code>k8s-libsonnet</code></a></li>
</ol>
<style>
html {
    margin: 0;
    padding: 0;
    min-height: 100%;
    background: lightgrey;
}

body {
    margin: 0;
    padding: 1.2em;
    min-height: 100%;
    margin-left: 15%;
    margin-right: 15%;
    background: white;
    border: thin solid grey;
    border-top: 0;
    /* sans-serif fonts are generally better readable for people with dyslexia */
    font-family: sans-serif;
    font-size: 1.15rem;
}

blockquote {
    background: lightyellow;
    padding: .1em;
    padding-left: 1em;
    margin-left: 0;
    margin-right: 0;
    display: flow-root;
    font-size: 1rem;
}

p {
    display: flow-root;
    line-height: 1.5em;
}

h1 a, h2 a, h3 a,
h4 a, h5 a, h6 a {
    text-decoration: none;
    color: black;
}

a.anchor-link {
    font-size: 0.9rem;
    vertical-align: middle;
    line-height: 1;
    margin: 0.2em;
    margin-left: -1.2em;
    color: lightgray;
}

h1, h2, h3, h4, h5, h6, hr {
    clear: both;
}

hr {
    visibility: hidden;
}

ol, ul {
    display: flow-root;
}

ol li,
ul li {
    line-height: 1.5em;
}

ul li code, p code {
    background: ghostwhite;
    padding: 0.2em;
}

pre ol {
    display: block;
}

pre {
    float: left;
    margin-top: 0;
    margin-right: 1em;
    width: min(50%, 70ch);
    overflow-x: scroll;
}

nav#toc {
    background: white;
    border: 1px solid grey;
    padding-right: 1em;
}

@media only screen and (max-width: 720px) {
    body {
        width: auto;
        margin-left: 0;
        margin-right: 0;
        border: 0;
    }
    pre {
        clear: both;
        float: none;
        width: min(95%, 70ch);
    }
}

li.L0, li.L1, li.L2, li.L3,
li.L5, li.L6, li.L7, li.L8 {
    list-style-type: decimal !important;
    line-height: normal;
}

</style>
<script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
<script>
var pres = document.getElementsByTagName('pre');
for (i=0;i<pres.length; i++) {
    pres[i].className='prettyprint linenums';
}
PR.prettyPrint();

// Source: https://attacomsian.com/blog/deep-anchor-links-javascript
document.querySelectorAll('h2, h3, h4, h5, h6').forEach($heading => {
    //create id from heading text
    var id = $heading.getAttribute("id") || $heading.innerText.toLowerCase().replace(/[`~!@#$%^&*()|+\-=?;:'",.<>\{\}\[\]\\\/]/gi, '').replace(/ +/g, '-');

    //add id to heading
    $heading.setAttribute('id', id);

    //append parent class to heading
    $heading.classList.add('anchor-heading');

    //create anchor
    var $anchor;
    $anchor = document.createElement('a');
    $anchor.className = 'anchor-link';
    $anchor.href = '#' + id;
    $anchor.innerHTML = '☍';

    //prepend anchor before heading text
    var text = $heading.innerText;
    $heading.innerText = "";
    $heading.appendChild($anchor);
    $heading.append(text);
});

var heading = document.querySelector('h1')

//create anchor
var anchor = document.createElement('a');
anchor.className = 'anchor-link';
anchor.innerHTML = '☰';
anchor.style.cursor = 'pointer';

var toc = document.createElement('nav');
toc.id = 'toc';
toc.style.display = 'none';

toc.addEventListener('mouseleave', e => {
    toc.style.display = 'none';
})
anchor.addEventListener('click', e => {
    toc.style.display = 'block';
})

document.querySelectorAll('h2, h3, h4, h5, h6').forEach($heading => {
    var level = $heading.nodeName.charAt(1);
    var current = toc;
    var ul
    var li;
    for (i=1; i<level; i++) {
      ul = current.querySelector('ul:last-child');
      if (ul == null) {
        ul = document.createElement('ul');
        current.appendChild(ul);
      } else {
        li = ul.querySelector('li:last-child');
      }
      current = li
    }

    var li = document.createElement('li');
    ul.appendChild(li)

    var headerId = $heading.id
    var a = document.createElement('a');
    a.href = '#' + headerId;
    var h = $heading;
    a.innerHTML = $heading.innerHTML;
    a.querySelectorAll('a').forEach($child => {
      a.removeChild($child);
    });
    li.appendChild(a)
})

if (document.querySelectorAll('h2, h3, h4, h5, h6').length > 0) {
    //prepend anchor before heading text
    var text = heading.innerText;
    heading.innerText = "";
    heading.appendChild(anchor);
    heading.append(text);

    toc.style.position = 'absolute';
    toc.style.top = anchor.offsetTop + 'px';
    toc.style.left = anchor.offsetLeft + 'px';

    document.querySelector('body').appendChild(toc);
}

</script>
</body>
</html>
